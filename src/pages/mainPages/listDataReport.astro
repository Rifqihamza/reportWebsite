---
type ReportStatus = "Pending" | "On Process" | "Complete";

const reports: Array<{
  id: number;
  tanggal: string;
  laporan: string;
  lokasi: string;
  pic: string;
  kategori: string;
  followup: string;
  status: ReportStatus;
}> = [
  {
    id: 1,
    tanggal: "2024-05-01",
    laporan: "Temuan kebocoran pipa di area workshop",
    lokasi: "Workshop A",
    pic: "Suhaimi",
    kategori: "Safety",
    followup: "Guru",
    status: "Pending",
  },
  {
    id: 2,
    tanggal: "2024-04-28",
    laporan: "Peralatan tidak tertata rapi setelah praktikum",
    lokasi: "Lab Komputer",
    pic: "Heas Priyo",
    kategori: "5R",
    followup: "Siswa",
    status: "On Process",
  },
  {
    id: 3,
    tanggal: "2024-04-25",
    laporan: "Material bahan praktik tercecer di lantai",
    lokasi: "Workshop B",
    pic: "Amalia",
    kategori: "5R",
    followup: "Siswa",
    status: "Complete",
  },
  {
    id: 4,
    tanggal: "2024-04-20",
    laporan: "AC ruangan tidak berfungsi dengan baik",
    lokasi: "Ruang Teori 3",
    pic: "Munir",
    kategori: "Kualitas",
    followup: "Vendor",
    status: "Complete",
  },
  {
    id: 5,
    tanggal: "2024-04-20",
    laporan: "AC ruangan tidak berfungsi dengan baik",
    lokasi: "Ruang Teori 8",
    pic: "Tya",
    kategori: "Kualitas",
    followup: "Vendor",
    status: "Complete",
  },
];

// Status color mapping
const statusColors = {
  Pending: "bg-red-100 text-red-800",
  "On Process": "bg-yellow-100 text-yellow-800",
  Complete: "bg-green-100 text-green-800",
};

// Format date helper function
function formatDate(dateStr: string) {
  // You can use a library like date-fns in a real app
  const date = new Date(dateStr);
  return new Intl.DateTimeFormat("id-ID", {
    year: "numeric",
    month: "long",
    day: "numeric",
  }).format(date);
}
---

<div>
  <div
    class="flex flex-col gap-4 md:gap-0 md:flex-row md:justify-between md:items-center mb-6"
  >
    <h2
      class="font-bold uppercase tracking-[2px] text-md flex flex-row gap-2 items-center"
    >
      <img src="../../../../public/reportDataIcon.svg" class="w-6 h-6" alt="" />
      Data Laporan
    </h2>

    <div class="flex space-x-2">
      <div class="relative">
        <input
          type="text"
          id="search-input"
          placeholder="Cari laporan..."
          class="w-full pl-9 pr-4 py-2 border placeholder:text-xs border-gray-300 rounded-lg outline-none"
        />
        <svg
          class="absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
        </svg>
      </div>

      <button
        id="filter-button"
        class="bg-red-900 shadow-inner shadow-zinc-500 text-white px-6 py-3 rounded-lg hover:bg-zinc-900 transition-colors"
        aria-label="Filter"
      >
        <svg
          class="h-4 w-4"
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"
          ></path>
        </svg>
      </button>
    </div>
  </div>

  <!-- Table for desktop -->
  <div class="hidden md:block overflow-x-auto rounded-xl">
    <table class="min-w-full">
      <thead class="bg-red-900">
        <tr>
          <th
            scope="col"
            class="px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider"
            >Tanggal</th
          >
          <th
            scope="col"
            class="px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider"
            >Laporan</th
          >
          <th
            scope="col"
            class="px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider"
            >Lokasi</th
          >
          <th
            scope="col"
            class="px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider"
            >PIC</th
          >
          <th
            scope="col"
            class="px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider"
            >Kategori</th
          >
          <th
            scope="col"
            class="px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider"
            >Status</th
          >
          <th
            scope="col"
            class="px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider"
            >Action</th
          >
        </tr>
      </thead>
      <tbody class="bg-white/20 backdrop-blur-md">
        {
          reports.map((report) => (
            <tr class="report-row" data-report-id={report.id}>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">
                {formatDate(report.tanggal)}
              </td>
              <td class="px-6 py-4 text-sm text-gray-600 max-w-[13rem] truncate">
                {report.laporan}
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">
                {report.lokasi}
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">
                {report.pic}
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">
                {report.kategori}
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <span
                  class={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${statusColors[report.status]}`}
                >
                  {report.status}
                </span>
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                <button class="detail-button text-blue-600 hover:text-blue-900 mr-3">
                  Detail
                </button>
              </td>
            </tr>
          ))
        }
      </tbody>
    </table>
  </div>

  <!-- Cards for mobile -->
  <div class="md:hidden space-y-4">
    {
      reports.map((report) => (
        <div
          class="report-card bg-white p-4 rounded-lg shadow-sm border border-gray-200"
          data-report-id={report.id}
        >
          <div class="flex justify-between items-start mb-2">
            <h3 class="font-medium text-gray-900 truncate">{report.laporan}</h3>
            <span
              class={`px-2 py-1 text-xs font-semibold rounded-full ${statusColors[report.status]}`}
            >
              {report.status}
            </span>
          </div>
          <div class="text-sm text-gray-500 space-y-1">
            <p>
              <span class="font-medium">Tanggal:</span>{" "}
              {formatDate(report.tanggal)}
            </p>
            <p>
              <span class="font-medium">Lokasi:</span> {report.lokasi}
            </p>
            <p>
              <span class="font-medium">PIC:</span> {report.pic}
            </p>
            <p>
              <span class="font-medium">Kategori:</span> {report.kategori}
            </p>
          </div>
          <div class="mt-3 flex justify-end">
            <button class="mobile-detail-button text-blue-600 hover:text-blue-900 text-sm font-medium">
              Lihat Detail
            </button>
          </div>
        </div>
      ))
    }
  </div>

  <!-- Pagination -->
  <div class="flex items-center justify-between mt-6">
    <div class="flex flex-row gap-2 items-center">
      <button
        class="px-6 py-1 bg-red-900 -translate-y-[8px] [box-shadow:0_6px_0_#d1c9b4] active:[box-shadow:0_2px_0_#d1c2b5] active:-translate-y-[3px] text-white rounded-xl cursor-pointer"
        >Prev</button
      >
      <button
        class="px-6 py-1 bg-red-900 -translate-y-[8px] [box-shadow:0_6px_0_#d1c9b4] active:[box-shadow:0_2px_0_#d1c2b5] active:-translate-y-[3px] text-white rounded-xl cursor-pointer"
        >Next</button
      >
    </div>
    <button
      class="px-6 py-1 bg-red-900 -translate-y-[8px] [box-shadow:0_6px_0_#d1c9b4] active:[box-shadow:0_2px_0_#d1c2b5] active:-translate-y-[3px] text-white rounded-xl cursor-pointer"
      >Logout</button
    >
  </div>
</div>
